<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/bootstrap/css/bootstrap.css">
    <link href="https://fonts.googleapis.com/css2?family=Balsamiq+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap"
        rel="stylesheet">
    <title>Kuis</title>
    <style>
        body {
            margin: 0;
            height: 100vh;
            font-family: "Balsamiq Sans", cursive;
            display: flex;
            align-items: center;
            justify-content: center;
            background-image: url("/css/Background.png");
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            overflow: hidden;
        }

        .title {
            font-weight: bold;
            color: #3c3c6e;
            animation: title 5s ease-in 0.3s alternate both;
        }

        @keyframes title {
            0% {
                opacity: 0;
                transform: scale(0.5);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                opacity: 1;
                transform: scale(1);
            }
        }


        .quiz-container {
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            width: 400px;
            background-color: #fcfcfc;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            /*   color: #464646; */
        }

        .option {
            display: block;
            border: none;
            cursor: pointer;
            background-color: #dddcdc;
            color: #3c3c6e;
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border-radius: 15px;
            font-size: 17px;
            font-weight: bold;
        }

        .option:hover {
            background-color: #c2c0c0;
            /* #d6e9ff */
        }

        .option:disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }

        .reset-btn {
            display: none;
            /* Awalnya disembunyikan */
            margin-top: 20px;
            padding: 10px 15px;
            background: #007bff;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }

        .reset-btn:hover {
            background: #0056b3;

        }
        
        .button-container {
            align-self: center;
            position: relative;
        }

        .button-container .button {
            font-family: "Balsamiq Sans", cursive;
            background: linear-gradient(90deg, #5db1e6, #104fdd);
            padding: 8px 20px;
            font-size: 16px;
            border-radius: 15px;
            color: white;
            text-decoration: none;
            font-weight: bold;
            display: inline-block;
            position: relative;
            text-decoration: none;
        }

        .button-container .button:hover {
            background: linear-gradient(90deg, #104fdd, #5db1e6);
        }

        .image-setting:active,
        .image-home:active,
        .image-setting-on:active,
        .audio-controls img:active {
            transform: translateY(10px);
        }

        .image-home {
            position: absolute;
            cursor: pointer;
            top: 10px;
            right: 55px;
            width: 40px;
            height: 40px;
            transition: all 0.3s ease;
        }

        .image-setting {
            position: absolute;
            cursor: pointer;
            top: 10px;
            right: 10px;
            width: 40px;
            height: 40px;
            transition: all 0.3s ease;
        }

        .image-setting-on {
            position: absolute;
            cursor: pointer;
            top: 10px;
            right: 10px;
            width: 40px;
            height: 40px;
            transition: all 0.3s ease;
        }

        .image-home:hover,
        .image-setting:hover,
        .image-setting-on:hover,
        .image-mute:hover,
        .image-sound:hover {
            transform: scale(1.3);
            border-radius: 100%;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }

        .audio-controls {
            position: absolute;
            top: 55px;
            right: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .audio-controls img {
            width: 40px;
            height: 40px;
            cursor: pointer;
        }

        .dekorasi_1 {
            position: absolute;
            width: 20%;
        }

        .dekorasi_2 {
            position: absolute;
            width: 10%;
        }

        .dekorasi-top-right-1 {
            top: 0;
            right: 0;
        }

        .dekorasi-bottom-left-1 {
            bottom: 0;
            left: 0;
            transform: rotate(180deg);
        }

        .dekorasi-top-left-2 {
            top: 0;
            left: 0;
        }

        .dekorasi-bottom-right-2 {
            bottom: 0;
            right: 0;
            transform: rotate(180deg);
        }

        @media (max-width: 930px) {
            .dekorasi-top-left-2,
            .dekorasi-bottom-left-1,
            .dekorasi-bottom-right-2,
            .dekorasi-top-right-1 {
                width: 30%;
            }
        }
    </style>
</head>

<body>
    <div class="quiz-container">
        <h4 class="title">What subjects are there on Monday, Wednesday, and Friday? ?</h4>
        <button class="option" onclick="checkAnswer(this, 'wrong')">A. English</button>
        <button class="option" onclick="checkAnswer(this, 'wrong')">B. Science</button>
        <button class="option" onclick="checkAnswer(this, 'correct')">C. Math</button>
        <button class="option" onclick="checkAnswer(this, 'wrong')">D. History</button>
        <br>

        <div class="button-container text-center mt-3">
            <a href="/script/halaman_navigasi/halaman_navigasi.html" class="button" id="button-next"
                onclick="nextQuestion()">Next</a>
        </div>
        <p id="feedback"></p>
        <button class="reset-btn" onclick="resetQuestion()">Coba Lagi</button>

        <!-- <button class="btn btn-primary mt-3" onclick="nextQuestion()">Next</button> -->
    </div>

    <img src="/Asset/icon/dekorasi_1.png" alt="Dekorasi_1" class="dekorasi_1 dekorasi-top-right-1">
    <img src="/Asset/icon/dekorasi_1.png" alt="Dekorasi 1" class="dekorasi_1 dekorasi-bottom-left-1">
    <img src="/Asset/icon/dekorasi_2.png" alt="Dekorasi 2" class="dekorasi_2 dekorasi-top-left-2">
    <img src="/Asset/icon/dekorasi_2.png" alt="Dekorasi 2" class="dekorasi_2 dekorasi-bottom-right-2">

    <img src="/Asset/icon/Setting.png" alt="Setting" class="image-setting" id="settingButton">
    <img src="/Asset/icon/Setting On.png" alt="Setting On" class="image-setting-on" id="settingOnButton"
        style="display: none;">

    <a href="/script/halaman_navigasi/halaman_navigasi.html">
        <img src="/Asset/icon/home.png" alt="Home" class="image-home">
    </a>

    <div class="audio-controls">
        <img src="/Asset/icon/Mute.png" alt="Mute" class="image-mute" id="muteButton" style="display: none;">
        <img src="/Asset/icon/Sound.png" alt="Sound" class="image-sound" id="soundButton" style="display: none;">
    </div>

    <audio id="audio" preload="auto" loop>
        <source id="audioSource" src="/Asset/audio/sound.mp3" type="audio/mp3">
    </audio>

    <audio id="correctSound">
        <source src="/Asset/audio/unit1/soal/correct.wav" type="audio/mp3">
    </audio>

    <audio id="wrongSound">
        <source src="/Asset/audio/unit1/soal/incorrect.mp3" type="audio/mp3">
    </audio>

    <script>

        // mengambil element menggunakan ID
        document.addEventListener("DOMContentLoaded", function () {
            const audio = document.getElementById("audio");
            const audioSource = document.getElementById("audioSource");
            const muteButton = document.getElementById("muteButton");
            const soundButton = document.getElementById("soundButton");
            const settingButton = document.getElementById("settingButton");
            const settingOnButton = document.getElementById("settingOnButton");

            // Daftar lagu
            const songs = [
                "/Asset/audio/sound.mp3",
                "/Asset/audio/audio2.mp3",
                "/Asset/audio/audio3.mp3"
            ];
            let currentSongIndex = 0;
            audio.loop = true;

            // Cek session untuk menyimpan progress audio
            if (sessionStorage.getItem("sessionActive")) {
                const savedTime = localStorage.getItem("audioTime");
                const savedIndex = localStorage.getItem("audioIndex");
                if (savedIndex !== null) {
                    currentSongIndex = parseInt(savedIndex);
                    audioSource.src = songs[currentSongIndex];
                    audio.load();
                }
                if (savedTime !== null) {
                    audio.currentTime = parseFloat(savedTime);
                }
            } else {
                localStorage.removeItem("audioTime");
                localStorage.removeItem("audioIndex");
                currentSongIndex = 0;
                audioSource.src = songs[currentSongIndex];
                audio.load();
            }

            sessionStorage.setItem("sessionActive", "true");

            // Atur status mute berdasarkan localStorage
            const isMuted = localStorage.getItem("audioMuted") === "true";
            audio.muted = isMuted;

            function playMainAudio() {
                audio.play().catch(() => {
                    console.log("Autoplay diblokir, menunggu interaksi pengguna.");
                });
            }
            playMainAudio();

            // Simpan progress audio
            audio.addEventListener("timeupdate", function () {
                if (sessionStorage.getItem("sessionActive")) {
                    localStorage.setItem("audioTime", audio.currentTime);
                    localStorage.setItem("audioIndex", currentSongIndex);
                }
            });

            function updateSoundButtons() {
                // Tampilkan tombol mute/sound sesuai dengan status audio
                if (audio.muted) {
                    muteButton.style.display = "block";
                    soundButton.style.display = "none";
                } else {
                    muteButton.style.display = "none";
                    soundButton.style.display = "block";
                }
            }

            // Event handler tombol mute dan sound
            muteButton.addEventListener("click", () => {
                audio.muted = false;
                localStorage.setItem("audioMuted", "false");
                updateSoundButtons();
            });

            soundButton.addEventListener("click", () => {
                audio.muted = true;
                localStorage.setItem("audioMuted", "true");
                updateSoundButtons();
            });

            // Atur tombol setting untuk memunculkan kontrol suara
            settingButton.addEventListener("click", () => {
                settingButton.style.display = "none";
                settingOnButton.style.display = "block";
                updateSoundButtons();
            });

            settingOnButton.addEventListener("click", () => {
                settingOnButton.style.display = "none";
                settingButton.style.display = "block";
                muteButton.style.display = "none";
                soundButton.style.display = "none";
            });

            // Inisialisasi tampilan tombol kontrol suara (disembunyikan secara default)
            muteButton.style.display = "none";
            soundButton.style.display = "none";
        });

        // Fungsi untuk memeriksa jawaban

        let originalStyles = [];

        function checkAnswer(button, status) {
            const feedback = document.getElementById("feedback");
            const correctSound = document.getElementById("correctSound");
            const wrongSound = document.getElementById("wrongSound");
            const buttons = document.querySelectorAll(".option");
            const resetBtn = document.querySelector(".reset-btn");

            // Simpan style asli hanya sekali
            if (originalStyles.length === 0) {
                buttons.forEach(btn => {
                    originalStyles.push({
                        element: btn,
                        background: btn.style.background,
                        color: btn.style.color,
                        border: btn.style.border
                    });
                });
            }

            // Kunci semua tombol setelah menjawab
            buttons.forEach(btn => btn.disabled = true);

            if (status === "correct") {
                feedback.textContent = "Jawaban Benar!";
                feedback.style.color = "green";
                button.style.background = "green";
                button.style.color = "white";
                correctSound.play();
            } else {
                feedback.textContent = "Jawaban Salah!";
                feedback.style.color = "red";
                button.style.background = "red";
                button.style.color = "white";
                wrongSound.play();
            }

            // Munculkan tombol reset
            resetBtn.style.display = "block";
        }

        function resetQuestion() {
            const feedback = document.getElementById("feedback");
            const buttons = document.querySelectorAll(".option");
            const resetBtn = document.querySelector(".reset-btn");

            // Kembalikan semua tombol ke style awal
            originalStyles.forEach(style => {
                style.element.style.background = style.background;
                style.element.style.color = style.color;
                style.element.style.border = style.border;
                style.element.disabled = false;
            });

            // Hapus feedback
            feedback.textContent = "";
            resetBtn.style.display = "none";
        }

            // Fungsi untuk pindah ke halaman berikutnya
        document.getElementById("button-next").addEventListener("click", function (event) {
            event.preventDefault(); // Mencegah navigasi langsung

            // Cek apakah ada tombol jawaban yang sudah ditekan
            let answered = document.querySelector(".option.selected");

            if (!answered) {
                // Jika belum ada jawaban yang dipilih, tampilkan peringatan
                Swal.fire({
                    icon: "warning",
                    title: "Jawab Soal Terlebih Dahulu!",
                    text: "Silakan pilih jawaban sebelum melanjutkan.",
                    confirmButtonText: "OK",
                    confirmButtonColor: "#ff9800",
                    backdrop: false, // Agar halaman tidak terkena overlay gelap
                    position: "center",
                    willOpen: () => {
                        document.body.style.overflow = "hidden"; // Cegah halaman bergeser
                    },
                    willClose: () => {
                        document.body.style.overflow = "auto"; // Kembalikan scroll normal
                    }
                });
                return;
            }

            // Jika sudah menjawab, tampilkan konfirmasi untuk lanjut
            Swal.fire({
                icon: "question",
                title: "Lanjut ke Pertanyaan Berikutnya?",
                text: "Apakah kamu yakin ingin melanjutkan?",
                showCancelButton: true,
                confirmButtonText: "Lanjut",
                cancelButtonText: "Batal",
                confirmButtonColor: "#28a745",
                cancelButtonColor: "#dc3545",
                backdrop: false, // Hindari overlay yang mengganggu tata letak
                position: "center"
            }).then((result) => {
                if (result.isConfirmed) {
                    // Jika pengguna menekan "Lanjut", pindah ke halaman baru
                    window.location.href = "/script/halaman_navigasi/halaman_navigasi.html";
                }
            });
        });

        // Tambahkan event listener ke setiap tombol jawaban
        document.querySelectorAll(".option").forEach(button => {
            button.addEventListener("click", function () {
                // Hapus class "selected" dari semua tombol jawaban
                document.querySelectorAll(".option").forEach(btn => btn.classList.remove("selected"));
                // Tambahkan class "selected" ke tombol yang diklik
                this.classList.add("selected");
            });
        });




    </script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

</body>

</html>